<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Quiz Sempoa Interaktif untuk Anak-Anak</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Luxury Wood Tones */
            --wood-dark: #3a2e1f;
            --wood-light: #5d4a36;
            --wood-accent: #8b7a65;
            --divider-color: #b8a692;
            
            /* Elegant Bead Colors */
            --bead-upper: #d4af37;
            --bead-upper-light: #f5d062;
            --bead-lower: #c0c0c0;
            --bead-lower-light: #e5e5e5;
            
            /* Sizing */
            --bead-size: min(13vw, 48px);
            --rod-spacing: min(3vw, 14px);
            --divider-height: min(2vw, 9px);
            --bead-gap: min(2vw, 9px);
            --extra-space: min(6vw, 23px);
            
            /* Bounce Effects */
            --bounce-timing: cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            margin: 0;
            padding: 0;
            background: #f5f1ea;
            color: #3a2e1f;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            touch-action: manipulation;
            overflow-x: hidden;
        }
        
        /* Login Screen Styles */
        .login-container {
            background: white;
            border-radius: 20px;
            padding: 40px 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            text-align: center;
            max-width: 400px;
            width: 90%;
            border: 2px solid var(--divider-color);
        }
        
        .login-title {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            color: var(--wood-dark);
            margin-bottom: 10px;
        }
        
        .login-subtitle {
            color: var(--wood-light);
            margin-bottom: 30px;
            font-size: 1rem;
        }
        
        .password-input {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--divider-color);
            border-radius: 10px;
            font-size: 1.1rem;
            text-align: center;
            margin-bottom: 20px;
            font-family: 'Montserrat', sans-serif;
            transition: all 0.3s ease;
        }
        
        .password-input:focus {
            outline: none;
            border-color: var(--bead-upper);
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.3);
        }
        
        .login-button {
            background: linear-gradient(145deg, var(--wood-dark), var(--wood-light));
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .login-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
        }
        
        .login-button:active {
            transform: translateY(0);
        }
        
        .error-message {
            color: #dc143c;
            margin-top: 15px;
            font-weight: 600;
            min-height: 20px;
        }
        
        .hint {
            margin-top: 20px;
            font-size: 0.9rem;
            color: var(--wood-light);
        }
        
        /* Main Game Container - Initially Hidden */
        .container {
            width: 94%;
            max-width: 460px;
            margin: 0 auto;
            padding: 20px 0;
            position: relative;
            z-index: 10;
            display: none; /* Hidden by default */
        }
        
        .abacus-frame {
            background: linear-gradient(145deg, var(--wood-dark), var(--wood-light));
            padding: min(4vw, 18px);
            border-radius: 18px;
            box-shadow: 
                0 15px 35px rgba(0, 0, 0, 0.2),
                inset 0 0 15px rgba(0, 0, 0, 0.3);
            border: 2px solid var(--divider-color);
            width: 100%;
            position: relative;
            overflow: hidden;
        }
        
        .branding {
            text-align: center;
            margin-bottom: 12px;
            position: relative;
            z-index: 4;
        }
        
        .brand {
            font-family: 'Playfair Display', serif;
            font-size: min(6vw, 1.8rem);
            font-weight: 700;
            color: var(--bead-upper);
            margin: 0;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
            letter-spacing: 1px;
        }
        
        .logo {
            font-family: 'Playfair Display', serif;
            font-size: min(4.5vw, 1.3rem);
            color: var(--bead-lower-light);
            margin-top: 4px;
            font-style: italic;
        }
        
        .rods-container {
            display: flex;
            justify-content: space-between;
            padding: min(3vw, 15px) 0;
            min-height: calc(var(--bead-size) * 8);
            position: relative;
        }
        
        .rod {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 var(--rod-spacing);
            position: relative;
        }
        
        .rod-line {
            position: absolute;
            width: 6px;
            height: 100%;
            background: linear-gradient(to bottom, 
                var(--wood-light), 
                var(--divider-color), 
                var(--wood-light));
            z-index: 1;
            border-radius: 4px;
            box-shadow: 
                inset 0 0 10px rgba(0, 0, 0, 0.4),
                0 0 5px rgba(0, 0, 0, 0.2);
        }
        
        .upper-bead {
            width: var(--bead-size);
            height: var(--bead-size);
            background: radial-gradient(circle at 30% 30%, 
                var(--bead-upper-light),
                var(--bead-upper) 70%);
            border-radius: 50%;
            margin-bottom: calc(var(--bead-gap) + var(--extra-space));
            cursor: pointer;
            position: relative;
            z-index: 2;
            box-shadow: 
                inset -5px -5px 10px rgba(0, 0, 0, 0.3),
                0 4px 8px rgba(0, 0, 0, 0.2),
                0 0 0 1px rgba(255,255,255,0.3);
            transition: all 0.4s var(--bounce-timing);
            border: 1px solid rgba(245, 208, 98, 0.5);
        }
        
        .lower-bead {
            width: var(--bead-size);
            height: var(--bead-size);
            background: radial-gradient(circle at 30% 30%, 
                var(--bead-lower-light),
                var(--bead-lower) 70%);
            border-radius: 50%;
            margin-bottom: var(--bead-gap);
            cursor: pointer;
            position: relative;
            z-index: 2;
            box-shadow: 
                inset -5px -5px 10px rgba(0, 0, 0, 0.3),
                0 4px 8px rgba(0, 0, 0, 0.2),
                0 0 0 1px rgba(255,255,255,0.3);
            transition: all 0.4s var(--bounce-timing);
            border: 1px solid rgba(192, 192, 192, 0.6);
        }
        
        .horizontal-divider {
            width: 140%;
            height: var(--divider-height);
            background: linear-gradient(90deg, 
                transparent, 
                var(--divider-color), 
                transparent);
            margin: calc(var(--extra-space) * 1.5) 0;
            position: relative;
            box-shadow: 
                inset 0 3px 6px rgba(0, 0, 0, 0.3),
                0 2px 5px rgba(0, 0, 0, 0.3);
            border-radius: 3px;
            z-index: 3;
        }
        
        .value-display {
            font-family: 'Playfair Display', serif;
            font-size: min(8vw, 2.4rem);
            color: var(--wood-dark);
            text-align: center;
            margin-top: min(3vw, 15px);
            letter-spacing: 2px;
            background: rgba(255, 255, 255, 0.3);
            padding: min(3vw, 10px) min(5vw, 20px);
            border-radius: 12px;
            border: 1px solid var(--divider-color);
            box-shadow: 
                inset 0 0 10px rgba(0, 0, 0, 0.1),
                0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .upper-bead.active {
            transform: translateY(calc(var(--bead-size) * 0.75 + var(--divider-height) / 2 + var(--extra-space) * 1.125)) scale(1.05);
            box-shadow: 
                inset -5px -5px 10px rgba(0, 0, 0, 0.3),
                0 6px 12px rgba(0, 0, 0, 0.25),
                0 0 0 2px rgba(255,255,255,0.4);
        }
        
        .lower-bead.active {
            transform: translateY(calc(var(--bead-size) * -0.25 - var(--divider-height) / 2 - var(--extra-space) * 0.375)) scale(1.05);
            box-shadow: 
                inset -5px -5px 10px rgba(0, 0, 0, 0.3),
                0 6px 12px rgba(0, 0, 0, 0.25),
                0 0 0 2px rgba(255,255,255,0.4);
        }
        
        .upper-bead:hover:not(.active), 
        .lower-bead:hover:not(.active) {
            transform: scale(1.08);
            filter: brightness(1.1);
        }
        
        /* Quiz Styles */
        .quiz-container {
            background: white;
            border-radius: 18px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--divider-color);
        }
        
        .quiz-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            color: var(--wood-dark);
            text-align: center;
            margin-bottom: 15px;
        }
        
        .question {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        .option {
            background: linear-gradient(145deg, var(--wood-light), var(--wood-dark));
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 20px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2);
        }
        
        .option:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 12px rgba(0, 0, 0, 0.25);
        }
        
        .feedback {
            text-align: center;
            font-weight: 600;
            margin-top: 15px;
            min-height: 24px;
        }
        
        .correct {
            color: #2e8b57;
        }
        
        .incorrect {
            color: #dc143c;
        }
        
        .score {
            text-align: center;
            font-weight: 600;
            margin-top: 15px;
            font-size: 1.1rem;
        }
        
        .timer {
            text-align: center;
            font-weight: 600;
            margin-top: 10px;
            font-size: 1rem;
            color: var(--wood-dark);
        }
        
        /* Button Styles */
        .button-container {
            display: flex;
            justify-content: center;
            margin-top: 15px;
            width: 100%;
        }
        
        .button {
            background: linear-gradient(145deg, var(--wood-dark), var(--wood-light));
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 30px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 
                0 5px 15px rgba(0, 0, 0, 0.2),
                inset 0 0 10px rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            letter-spacing: 1px;
            margin: 0 10px;
        }
        
        .button:hover {
            transform: translateY(-3px);
            box-shadow: 
                0 8px 20px rgba(0, 0, 0, 0.25),
                inset 0 0 15px rgba(255, 255, 255, 0.15);
        }
        
        .button:active {
            transform: translateY(0);
            box-shadow: 
                0 3px 10px rgba(0, 0, 0, 0.2),
                inset 0 0 5px rgba(255, 255, 255, 0.1);
        }
        
        .button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.2),
                transparent
            );
            transition: all 0.5s ease;
        }
        
        .button:hover::before {
            left: 100%;
        }
        
        /* Color Preset Selector */
        .color-presets {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
            margin-top: 20px;
            padding: 0 10px;
            max-width: 460px;
        }
        
        .color-preset {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .color-preset:hover {
            transform: scale(1.1);
        }
        
        .color-preset.active {
            border: 2px solid #fff;
            box-shadow: 0 0 0 3px var(--wood-dark);
            transform: scale(1.1);
        }
        
        .preset-label {
            text-align: center;
            margin-top: 15px;
            font-weight: 600;
            color: var(--wood-dark);
            font-size: 0.9rem;
        }
        
        /* Fireworks Animation */
        .fireworks-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 100;
        }
        
        .firework {
            position: absolute;
            width: 5px;
            height: 5px;
            border-radius: 50%;
            box-shadow: 0 0 10px 2px;
            animation: explode 1s ease-out forwards;
        }
        
        @keyframes explode {
            0% {
                transform: translate(0, 0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translate(var(--tx), var(--ty)) scale(0);
                opacity: 0;
            }
        }
        
        .celebration-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Playfair Display', serif;
            font-size: 3rem;
            font-weight: 700;
            color: #ffd700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
            z-index: 101;
            text-align: center;
            animation: pulse 1.5s infinite alternate;
            pointer-events: none;
            display: none;
        }
        
        @keyframes pulse {
            0% {
                transform: translate(-50%, -50%) scale(1);
                text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
            }
            100% {
                transform: translate(-50%, -50%) scale(1.1);
                text-shadow: 0 0 20px rgba(255, 215, 0, 1), 0 0 30px rgba(255, 215, 0, 0.8);
            }
        }
        
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 99;
            display: none;
        }
        
        .win-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            z-index: 102;
            max-width: 80%;
            display: none;
        }
        
        .win-title {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            color: #d4af37;
            margin-bottom: 15px;
        }
        
        .win-time {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: #3a2e1f;
        }
        
        .restart-button {
            background: linear-gradient(145deg, #d4af37, #f5d062);
            color: #3a2e1f;
            border: none;
            padding: 12px 24px;
            border-radius: 30px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }
        
        .restart-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
        }
        
        .level-indicator {
            text-align: center;
            font-weight: 600;
            margin-top: 10px;
            color: var(--wood-dark);
            font-size: 1rem;
        }
        
        .attempts {
            text-align: center;
            font-weight: 600;
            margin-top: 5px;
            color: var(--wood-dark);
            font-size: 0.9rem;
        }
        
        /* Report Styles */
        .report-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            z-index: 103;
            max-width: 90%;
            max-height: 80%;
            overflow-y: auto;
            display: none;
        }
        
        .report-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            color: #d4af37;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .chart-container {
            width: 100%;
            height: 200px;
            margin: 20px 0;
            position: relative;
        }
        
        .chart-bar {
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            height: 150px;
            margin-bottom: 20px;
            border-bottom: 2px solid #3a2e1f;
        }
        
        .bar {
            width: 30px;
            background: linear-gradient(to top, #d4af37, #f5d062);
            border-radius: 5px 5px 0 0;
            position: relative;
            transition: height 0.5s ease;
        }
        
        .bar-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            font-weight: 600;
            color: #3a2e1f;
        }
        
        .bar-value {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            font-weight: 600;
            color: #3a2e1f;
        }
        
        .report-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        
        .stat-item {
            background: #f5f1ea;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #d4af37;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #3a2e1f;
        }
        
        .close-report {
            background: linear-gradient(145deg, #3a2e1f, #5d4a36);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            width: 100%;
        }
        
        .close-report:hover {
            background: linear-gradient(145deg, #5d4a36, #3a2e1f);
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-container" id="login-container">
        <div class="login-title">Quiz Sempoa</div>
        <div class="login-subtitle">Masukkan kode akses untuk memulai</div>
        <input type="password" class="password-input" id="password-input" placeholder="Masukkan kode rahasia" maxlength="8">
        <button class="login-button" id="login-button">Masuk</button>
        <div class="error-message" id="error-message"></div>
        <div class="hint">Kode akses terdiri dari 8 digit angka</div>
    </div>

    <!-- Main Game (Initially Hidden) -->
    <div class="overlay" id="overlay"></div>
    
    <div class="celebration-message" id="celebration-message">HOORAY!</div>
    
    <div class="win-message" id="win-message">
        <div class="win-title" id="win-title">Selamat!</div>
        <div class="win-time" id="win-time">Kamu telah menyelesaikan level!</div>
        <button class="restart-button" id="restart-button">Level Berikutnya</button>
    </div>
    
    <div class="report-container" id="report-container">
        <div class="report-title">Laporan Skor</div>
        <div class="chart-container">
            <div class="chart-bar" id="chart-bar">
                <!-- Chart bars will be generated by JavaScript -->
            </div>
        </div>
        <div class="report-stats" id="report-stats">
            <!-- Stats will be generated by JavaScript -->
        </div>
        <button class="close-report" id="close-report">Tutup Laporan</button>
    </div>
    
    <div class="fireworks-container" id="fireworks-container"></div>
    
    <div class="container" id="game-container">
        <div class="abacus-frame">
            <div class="branding">
                <div class="brand">QUIZ SEMPOA</div>
                <div class="logo">Belajar Sempoa dengan Menyenangkan</div>
            </div>
            
            <div class="rods-container" id="rods-container">
                <!-- Rods will be generated by JavaScript -->
            </div>
            
            <div class="value-display" id="value-display">0</div>
        </div>
        
        <div class="button-container">
            <button class="button" id="reset-button">Reset Sempoa</button>
            <button class="button" id="next-question">Soal Berikutnya</button>
        </div>
        
        <div class="quiz-container">
            <div class="quiz-title">Quiz Sempoa</div>
            <div class="level-indicator" id="level-indicator">Level 1 - Soal 1/10</div>
            <div class="attempts" id="attempts">Percobaan: 1/5</div>
            <div class="question" id="question">Tunjukkan angka 7 pada sempoa!</div>
            <div class="options" id="options">
                <!-- Options will be generated by JavaScript -->
            </div>
            <div class="feedback" id="feedback"></div>
            <div class="score" id="score">Skor: 0/10</div>
            <div class="timer" id="timer">Waktu: 1:00</div>
        </div>
        
        <div class="preset-label">Pilih Warna Sempoa:</div>
        <div class="color-presets" id="color-presets">
            <!-- Color presets will be generated by JavaScript -->
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Login Elements
            const loginContainer = document.getElementById('login-container');
            const passwordInput = document.getElementById('password-input');
            const loginButton = document.getElementById('login-button');
            const errorMessage = document.getElementById('error-message');
            const gameContainer = document.getElementById('game-container');
            
            // Game Elements
            const rodCount = 5;
            const rodsContainer = document.getElementById('rods-container');
            const valueDisplay = document.getElementById('value-display');
            const colorPresetsContainer = document.getElementById('color-presets');
            const resetButton = document.getElementById('reset-button');
            const nextQuestionButton = document.getElementById('next-question');
            const questionElement = document.getElementById('question');
            const optionsElement = document.getElementById('options');
            const feedbackElement = document.getElementById('feedback');
            const scoreElement = document.getElementById('score');
            const timerElement = document.getElementById('timer');
            const celebrationMessage = document.getElementById('celebration-message');
            const fireworksContainer = document.getElementById('fireworks-container');
            const overlay = document.getElementById('overlay');
            const winMessage = document.getElementById('win-message');
            const winTitle = document.getElementById('win-title');
            const winTime = document.getElementById('win-time');
            const restartButton = document.getElementById('restart-button');
            const levelIndicator = document.getElementById('level-indicator');
            const attemptsElement = document.getElementById('attempts');
            const reportContainer = document.getElementById('report-container');
            const chartBar = document.getElementById('chart-bar');
            const reportStats = document.getElementById('report-stats');
            const closeReport = document.getElementById('close-report');
            
            // Game State Variables
            let rods = [];
            let currentQuestion = 0;
            let score = 0;
            let startTime;
            let timerInterval;
            let isGameActive = true;
            let currentLevel = 1;
            let questionsAnswered = 0;
            let timeLimit = 60; // 1 menit dalam detik
            let timeLeft = timeLimit;
            let attempts = 1;
            let maxAttempts = 5;
            let sessionScores = [];
            let currentQuestions = [];
            
            // Secret Password
            const SECRET_PASSWORD = "12345678";
            
            // Login Functionality
            function checkPassword() {
                const enteredPassword = passwordInput.value.trim();
                
                if (enteredPassword === SECRET_PASSWORD) {
                    // Password correct - show game
                    loginContainer.style.display = 'none';
                    gameContainer.style.display = 'block';
                    initializeGame();
                } else {
                    // Password incorrect - show error
                    errorMessage.textContent = "Kode akses salah! Silakan coba lagi.";
                    passwordInput.value = '';
                    passwordInput.focus();
                    
                    // Add shake animation to input
                    passwordInput.style.animation = 'none';
                    setTimeout(() => {
                        passwordInput.style.animation = 'shake 0.5s';
                    }, 10);
                }
            }
            
            // Add shake animation for wrong password
            const style = document.createElement('style');
            style.textContent = `
                @keyframes shake {
                    0%, 100% { transform: translateX(0); }
                    10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
                    20%, 40%, 60%, 80% { transform: translateX(5px); }
                }
            `;
            document.head.appendChild(style);
            
            // Login event listeners
            loginButton.addEventListener('click', checkPassword);
            passwordInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    checkPassword();
                }
            });
            
            // Focus on password input when page loads
            passwordInput.focus();
            
            // 50 Soal berbeda untuk variasi
            const allQuestions = [
                // Level 1: Angka 1-99
                { question: "Tunjukkan angka 7 pada sempoa!", answer: 7 },
                { question: "Tunjukkan angka 12 pada sempoa!", answer: 12 },
                { question: "Tunjukkan angka 25 pada sempoa!", answer: 25 },
                { question: "Tunjukkan angka 38 pada sempoa!", answer: 38 },
                { question: "Tunjukkan angka 50 pada sempoa!", answer: 50 },
                { question: "Tunjukkan angka 63 pada sempoa!", answer: 63 },
                { question: "Tunjukkan angka 77 pada sempoa!", answer: 77 },
                { question: "Tunjukkan angka 89 pada sempoa!", answer: 89 },
                { question: "Tunjukkan angka 94 pada sempoa!", answer: 94 },
                { question: "Tunjukkan angka 100 pada sempoa!", answer: 100 },
                
                // Level 1: Angka tambahan
                { question: "Tunjukkan angka 15 pada sempoa!", answer: 15 },
                { question: "Tunjukkan angka 27 pada sempoa!", answer: 27 },
                { question: "Tunjukkan angka 36 pada sempoa!", answer: 36 },
                { question: "Tunjukkan angka 42 pada sempoa!", answer: 42 },
                { question: "Tunjukkan angka 58 pada sempoa!", answer: 58 },
                { question: "Tunjukkan angka 64 pada sempoa!", answer: 64 },
                { question: "Tunjukkan angka 71 pada sempoa!", answer: 71 },
                { question: "Tunjukkan angka 83 pada sempoa!", answer: 83 },
                { question: "Tunjukkan angka 96 pada sempoa!", answer: 96 },
                { question: "Tunjukkan angka 105 pada sempoa!", answer: 105 },
                
                // Level 2: Angka 100-199
                { question: "Tunjukkan angka 123 pada sempoa!", answer: 123 },
                { question: "Tunjukkan angka 156 pada sempoa!", answer: 156 },
                { question: "Tunjukkan angka 189 pada sempoa!", answer: 189 },
                { question: "Tunjukkan angka 204 pada sempoa!", answer: 204 },
                { question: "Tunjukkan angka 237 pada sempoa!", answer: 237 },
                { question: "Tunjukkan angka 268 pada sempoa!", answer: 268 },
                { question: "Tunjukkan angka 295 pada sempoa!", answer: 295 },
                { question: "Tunjukkan angka 312 pada sempoa!", answer: 312 },
                { question: "Tunjukkan angka 347 pada sempoa!", answer: 347 },
                { question: "Tunjukkan angka 399 pada sempoa!", answer: 399 },
                
                // Level 2: Angka tambahan
                { question: "Tunjukkan angka 111 pada sempoa!", answer: 111 },
                { question: "Tunjukkan angka 128 pada sempoa!", answer: 128 },
                { question: "Tunjukkan angka 145 pada sempoa!", answer: 145 },
                { question: "Tunjukkan angka 162 pada sempoa!", answer: 162 },
                { question: "Tunjukkan angka 179 pada sempoa!", answer: 179 },
                { question: "Tunjukkan angka 196 pada sempoa!", answer: 196 },
                { question: "Tunjukkan angka 213 pada sempoa!", answer: 213 },
                { question: "Tunjukkan angka 230 pada sempoa!", answer: 230 },
                { question: "Tunjukkan angka 247 pada sempoa!", answer: 247 },
                { question: "Tunjukkan angka 264 pada sempoa!", answer: 264 },
                
                // Level 3: Angka 200-399
                { question: "Tunjukkan angka 281 pada sempoa!", answer: 281 },
                { question: "Tunjukkan angka 298 pada sempoa!", answer: 298 },
                { question: "Tunjukkan angka 315 pada sempoa!", answer: 315 },
                { question: "Tunjukkan angka 332 pada sempoa!", answer: 332 },
                { question: "Tunjukkan angka 349 pada sempoa!", answer: 349 },
                { question: "Tunjukkan angka 366 pada sempoa!", answer: 366 },
                { question: "Tunjukkan angka 383 pada sempoa!", answer: 383 },
                { question: "Tunjukkan angka 400 pada sempoa!", answer: 400 },
                { question: "Tunjukkan angka 417 pada sempoa!", answer: 417 },
                { question: "Tunjukkan angka 434 pada sempoa!", answer: 434 },
                
                // Level 3: Angka tambahan
                { question: "Tunjukkan angka 451 pada sempoa!", answer: 451 },
                { question: "Tunjukkan angka 468 pada sempoa!", answer: 468 },
                { question: "Tunjukkan angka 485 pada sempoa!", answer: 485 },
                { question: "Tunjukkan angka 502 pada sempoa!", answer: 502 },
                { question: "Tunjukkan angka 519 pada sempoa!", answer: 519 },
                { question: "Tunjukkan angka 536 pada sempoa!", answer: 536 },
                { question: "Tunjukkan angka 553 pada sempoa!", answer: 553 },
                { question: "Tunjukkan angka 570 pada sempoa!", answer: 570 },
                { question: "Tunjukkan angka 587 pada sempoa!", answer: 587 },
                { question: "Tunjukkan angka 604 pada sempoa!", answer: 604 }
            ];
            
            // Fungsi untuk mendapatkan 10 soal acak untuk percobaan saat ini
            function getRandomQuestions() {
                // Buat salinan dari semua soal
                const availableQuestions = [...allQuestions];
                const selectedQuestions = [];
                
                // Acak urutan soal
                for (let i = availableQuestions.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [availableQuestions[i], availableQuestions[j]] = [availableQuestions[j], availableQuestions[i]];
                }
                
                // Ambil 10 soal pertama
                for (let i = 0; i < 10; i++) {
                    selectedQuestions.push(availableQuestions[i]);
                }
                
                return selectedQuestions;
            }
            
            function initializeGame() {
                createAbacus();
                createColorPresets();
                
                // Dapatkan soal acak untuk permainan pertama
                currentQuestions = getRandomQuestions();
                
                displayQuestion();
                startTimer();
                
                // Apply the first preset by default
                const firstPreset = {
                    woodDark: "#3a2e1f",
                    woodLight: "#5d4a36",
                    dividerColor: "#b8a692",
                    beadUpper: "#d4af37",
                    beadUpperLight: "#f5d062",
                    beadLower: "#c0c0c0",
                    beadLowerLight: "#e5e5e5"
                };
                applyColorPreset(firstPreset);
                document.querySelector('.color-preset').classList.add('active');
                
                // Add event listeners
                resetButton.addEventListener('click', resetAbacus);
                nextQuestionButton.addEventListener('click', nextQuestion);
                restartButton.addEventListener('click', function() {
                    if (attempts < maxAttempts) {
                        nextAttempt();
                    } else {
                        nextLevel();
                    }
                });
                closeReport.addEventListener('click', resetGame);
            }
            
            function createAbacus() {
                rodsContainer.innerHTML = '';
                rods = [];
                
                for (let i = 0; i < rodCount; i++) {
                    const rod = document.createElement('div');
                    rod.className = 'rod';
                    
                    const rodLine = document.createElement('div');
                    rodLine.className = 'rod-line';
                    rod.appendChild(rodLine);
                    
                    // Upper bead (value 5)
                    const upperBead = document.createElement('div');
                    upperBead.className = 'upper-bead';
                    upperBead.dataset.value = '5';
                    upperBead.dataset.rodIndex = i;
                    rod.appendChild(upperBead);
                    
                    // Divider
                    const divider = document.createElement('div');
                    divider.className = 'horizontal-divider';
                    rod.appendChild(divider);
                    
                    // Lower beads (4 beads, value 1 each)
                    for (let j = 0; j < 4; j++) {
                        const lowerBead = document.createElement('div');
                        lowerBead.className = 'lower-bead';
                        lowerBead.dataset.value = '1';
                        lowerBead.dataset.rodIndex = i;
                        lowerBead.dataset.beadIndex = j;
                        rod.appendChild(lowerBead);
                    }
                    
                    rodsContainer.appendChild(rod);
                    rods.push({ upperActive: false, lowerActive: [] });
                }
                
                // Fixed click handlers
                document.querySelectorAll('.upper-bead').forEach(bead => {
                    bead.addEventListener('click', function() {
                        if (!isGameActive) return;
                        const rodIndex = parseInt(this.dataset.rodIndex);
                        rods[rodIndex].upperActive = !rods[rodIndex].upperActive;
                        this.classList.toggle('active');
                        calculateTotal();
                    });
                });
                
                document.querySelectorAll('.lower-bead').forEach(bead => {
                    bead.addEventListener('click', function() {
                        if (!isGameActive) return;
                        const rodIndex = parseInt(this.dataset.rodIndex);
                        const beadIndex = parseInt(this.dataset.beadIndex);
                        
                        if (!this.classList.contains('active')) {
                            if (beadIndex === 0 || rods[rodIndex].lowerActive.includes(beadIndex - 1)) {
                                this.classList.add('active');
                                rods[rodIndex].lowerActive.push(beadIndex);
                                rods[rodIndex].lowerActive.sort((a, b) => a - b);
                            }
                        } else {
                            if (beadIndex === rods[rodIndex].lowerActive[rods[rodIndex].lowerActive.length - 1]) {
                                this.classList.remove('active');
                                rods[rodIndex].lowerActive = rods[rodIndex].lowerActive.filter(b => b !== beadIndex);
                            }
                        }
                        
                        calculateTotal();
                    });
                });
            }
            
            function calculateTotal() {
                let total = 0;
                
                rods.forEach((rod, index) => {
                    const placeValue = Math.pow(10, rodCount - index - 1);
                    const rodValue = (rod.upperActive ? 5 : 0) + rod.lowerActive.length;
                    total += rodValue * placeValue;
                });
                
                valueDisplay.textContent = total.toLocaleString('id-ID');
                
                // Check if the current value matches the answer
                if (total === currentQuestions[currentQuestion].answer) {
                    feedbackElement.textContent = "Benar! Jawaban Anda tepat.";
                    feedbackElement.className = "feedback correct";
                    
                    // Increase score and questions answered
                    score++;
                    questionsAnswered++;
                    updateScore();
                    
                    // Check if player has completed 10 questions
                    if (questionsAnswered >= 10) {
                        endLevel();
                        return;
                    }
                    
                    // Automatically move to next question after a short delay
                    setTimeout(() => {
                        nextQuestion();
                    }, 1500);
                }
            }
            
            function createColorPresets() {
                colorPresetsContainer.innerHTML = '';
                
                const colorPresets = [
                    {
                        name: "Classic Gold",
                        woodDark: "#3a2e1f",
                        woodLight: "#5d4a36",
                        dividerColor: "#b8a692",
                        beadUpper: "#d4af37",
                        beadUpperLight: "#f5d062",
                        beadLower: "#c0c0c0",
                        beadLowerLight: "#e5e5e5"
                    },
                    {
                        name: "Royal Blue",
                        woodDark: "#1a1a2e",
                        woodLight: "#16213e",
                        dividerColor: "#0f3460",
                        beadUpper: "#e94560",
                        beadUpperLight: "#ff6b81",
                        beadLower: "#8bd5cb",
                        beadLowerLight: "#b8f2e6"
                    },
                    {
                        name: "Emerald Green",
                        woodDark: "#1e3d2e",
                        woodLight: "#2d5a3e",
                        dividerColor: "#4a7856",
                        beadUpper: "#f4a261",
                        beadUpperLight: "#f7c78e",
                        beadLower: "#2a9d8f",
                        beadLowerLight: "#7fdbca"
                    }
                ];
                
                colorPresets.forEach((preset, index) => {
                    const presetElement = document.createElement('div');
                    presetElement.className = 'color-preset';
                    presetElement.style.background = `linear-gradient(135deg, ${preset.beadUpper}, ${preset.beadLower})`;
                    presetElement.title = preset.name;
                    presetElement.dataset.index = index;
                    
                    presetElement.addEventListener('click', function() {
                        applyColorPreset(preset);
                        
                        // Update active state
                        document.querySelectorAll('.color-preset').forEach(el => {
                            el.classList.remove('active');
                        });
                        this.classList.add('active');
                    });
                    
                    colorPresetsContainer.appendChild(presetElement);
                });
            }
            
            function applyColorPreset(preset) {
                // Update CSS variables
                document.documentElement.style.setProperty('--wood-dark', preset.woodDark);
                document.documentElement.style.setProperty('--wood-light', preset.woodLight);
                document.documentElement.style.setProperty('--divider-color', preset.dividerColor);
                document.documentElement.style.setProperty('--bead-upper', preset.beadUpper);
                document.documentElement.style.setProperty('--bead-upper-light', preset.beadUpperLight);
                document.documentElement.style.setProperty('--bead-lower', preset.beadLower);
                document.documentElement.style.setProperty('--bead-lower-light', preset.beadLowerLight);
                
                // Update text colors for better contrast
                const brand = document.querySelector('.brand');
                const logo = document.querySelector('.logo');
                const valueDisplay = document.getElementById('value-display');
                
                brand.style.color = preset.beadUpper;
                logo.style.color = preset.beadLowerLight;
                valueDisplay.style.color = preset.woodDark;
            }
            
            function resetAbacus() {
                // Reset all beads to inactive state
                rods.forEach((rod, index) => {
                    rod.upperActive = false;
                    rod.lowerActive = [];
                });
                
                // Remove active class from all beads
                document.querySelectorAll('.upper-bead, .lower-bead').forEach(bead => {
                    bead.classList.remove('active');
                });
                
                // Reset display value
                valueDisplay.textContent = '0';
                
                // Add a subtle animation effect to show reset
                const abacusFrame = document.querySelector('.abacus-frame');
                abacusFrame.style.opacity = '0.7';
                setTimeout(() => {
                    abacusFrame.style.opacity = '1';
                }, 300);
            }
            
            function displayQuestion() {
                questionElement.textContent = currentQuestions[currentQuestion].question;
                feedbackElement.textContent = "";
                feedbackElement.className = "feedback";
                levelIndicator.textContent = `Level ${currentLevel} - Soal ${questionsAnswered + 1}/10`;
                attemptsElement.textContent = `Percobaan: ${attempts}/${maxAttempts}`;
                resetAbacus();
            }
            
            function nextQuestion() {
                currentQuestion++;
                if (currentQuestion >= currentQuestions.length) {
                    currentQuestion = 0;
                }
                displayQuestion();
            }
            
            function updateScore() {
                scoreElement.textContent = `Skor: ${score}`;
            }
            
            function startTimer() {
                startTime = new Date();
                timeLeft = timeLimit;
                updateTimer();
                timerInterval = setInterval(updateTimer, 1000);
            }
            
            function updateTimer() {
                const currentTime = new Date();
                const elapsedTime = Math.floor((currentTime - startTime) / 1000);
                timeLeft = timeLimit - elapsedTime;
                
                if (timeLeft <= 0) {
                    timeLeft = 0;
                    endGame();
                }
                
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timerElement.textContent = `Waktu: ${minutes}:${seconds.toString().padStart(2, '0')}`;
            }
            
            function endLevel() {
                isGameActive = false;
                clearInterval(timerInterval);
                
                // Save score for this attempt
                sessionScores.push(score);
                
                // Show celebration
                celebrationMessage.style.display = 'block';
                createFireworks();
                
                // Show win message after a delay
                setTimeout(() => {
                    celebrationMessage.style.display = 'none';
                    winTitle.textContent = "Level Selesai!";
                    winTime.textContent = `Kamu telah menyelesaikan ${questionsAnswered} soal di Level ${currentLevel}!`;
                    winMessage.style.display = 'block';
                    overlay.style.display = 'block';
                }, 3000);
            }
            
            function endGame() {
                isGameActive = false;
                clearInterval(timerInterval);
                
                // Save score for this attempt
                sessionScores.push(score);
                
                // Check if we've reached max attempts
                if (attempts >= maxAttempts) {
                    showReport();
                } else {
                    // Show time's up message and prepare for next attempt
                    winTitle.textContent = "Waktu Habis!";
                    winTime.textContent = `Skor kamu: ${score}. Siap untuk percobaan ${attempts + 1}?`;
                    winMessage.style.display = 'block';
                    overlay.style.display = 'block';
                    restartButton.textContent = "Percobaan Berikutnya";
                }
            }
            
            function showReport() {
                // Create chart
                chartBar.innerHTML = '';
                for (let i = 0; i < sessionScores.length; i++) {
                    const bar = document.createElement('div');
                    bar.className = 'bar';
                    const height = (sessionScores[i] / 10) * 100;
                    bar.style.height = `${height}px`;
                    
                    const label = document.createElement('div');
                    label.className = 'bar-label';
                    label.textContent = `P${i+1}`;
                    
                    const value = document.createElement('div');
                    value.className = 'bar-value';
                    value.textContent = sessionScores[i];
                    
                    bar.appendChild(label);
                    bar.appendChild(value);
                    chartBar.appendChild(bar);
                }
                
                // Create stats
                reportStats.innerHTML = '';
                
                const totalScore = sessionScores.reduce((a, b) => a + b, 0);
                const averageScore = Math.round(totalScore / sessionScores.length);
                const bestScore = Math.max(...sessionScores);
                const worstScore = Math.min(...sessionScores);
                
                const stats = [
                    { label: "Total Skor", value: totalScore },
                    { label: "Rata-rata", value: averageScore },
                    { label: "Skor Tertinggi", value: bestScore },
                    { label: "Skor Terendah", value: worstScore }
                ];
                
                stats.forEach(stat => {
                    const statItem = document.createElement('div');
                    statItem.className = 'stat-item';
                    
                    const statValue = document.createElement('div');
                    statValue.className = 'stat-value';
                    statValue.textContent = stat.value;
                    
                    const statLabel = document.createElement('div');
                    statLabel.className = 'stat-label';
                    statLabel.textContent = stat.label;
                    
                    statItem.appendChild(statValue);
                    statItem.appendChild(statLabel);
                    reportStats.appendChild(statItem);
                });
                
                // Show report
                reportContainer.style.display = 'block';
                overlay.style.display = 'block';
            }
            
            function createFireworks() {
                const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ffffff'];
                
                for (let i = 0; i < 100; i++) {
                    setTimeout(() => {
                        const firework = document.createElement('div');
                        firework.className = 'firework';
                        
                        // Random position
                        const x = Math.random() * window.innerWidth;
                        const y = Math.random() * window.innerHeight;
                        
                        // Random color
                        const color = colors[Math.floor(Math.random() * colors.length)];
                        firework.style.backgroundColor = color;
                        firework.style.boxShadow = `0 0 10px 2px ${color}`;
                        
                        // Random movement
                        const tx = (Math.random() - 0.5) * 200;
                        const ty = (Math.random() - 0.5) * 200;
                        firework.style.setProperty('--tx', `${tx}px`);
                        firework.style.setProperty('--ty', `${ty}px`);
                        
                        firework.style.left = `${x}px`;
                        firework.style.top = `${y}px`;
                        
                        fireworksContainer.appendChild(firework);
                        
                        // Remove firework after animation
                        setTimeout(() => {
                            firework.remove();
                        }, 1000);
                    }, i * 50);
                }
            }
            
            function nextAttempt() {
                attempts++;
                currentQuestion = 0;
                score = 0;
                questionsAnswered = 0;
                isGameActive = true;
                celebrationMessage.style.display = 'none';
                overlay.style.display = 'none';
                winMessage.style.display = 'none';
                fireworksContainer.innerHTML = '';
                
                // Dapatkan soal acak baru untuk percobaan ini
                currentQuestions = getRandomQuestions();
                
                updateScore();
                displayQuestion();
                startTimer();
            }
            
            function nextLevel() {
                currentLevel++;
                currentQuestion = 0;
                questionsAnswered = 0;
                isGameActive = true;
                celebrationMessage.style.display = 'none';
                overlay.style.display = 'none';
                winMessage.style.display = 'none';
                fireworksContainer.innerHTML = '';
                
                // Dapatkan soal acak baru untuk level ini
                currentQuestions = getRandomQuestions();
                
                updateScore();
                displayQuestion();
                startTimer();
            }
            
            function resetGame() {
                currentLevel = 1;
                currentQuestion = 0;
                score = 0;
                questionsAnswered = 0;
                attempts = 1;
                sessionScores = [];
                isGameActive = true;
                celebrationMessage.style.display = 'none';
                overlay.style.display = 'none';
                winMessage.style.display = 'none';
                reportContainer.style.display = 'none';
                fireworksContainer.innerHTML = '';
                
                // Dapatkan soal acak baru untuk permainan baru
                currentQuestions = getRandomQuestions();
                
                updateScore();
                displayQuestion();
                startTimer();
            }
        });
    </script>
</body>
</html>
